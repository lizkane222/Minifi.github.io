<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head') %>
    <title><%=page_title%></title>

</head>

<body>
    <header>
        <%- include('../partials/navbar') %>
    </header>
<!-- new exercise form -->
<!-- <h2>Let's LOG a new motivation</h2> -->

<!-- <p>PUT FORM HERE</p> -->
<!-- <main>
    <form action="/motivate" method="POST">
        <input type="text" name="name" placeholder="Motivation Name">
        <input type="text" name="type" placeholder="Type of Motivation">
        <input type="text" name="duration" placeholder="Duration">
        <input type="text" name="groupSize" placeholder="Group Size: self, partner, small-group, large-group">
        <br/>
        <h4>Per Exercise</h4>
        <input type="text" name="perExercise.type" placeholder="perExercise.type">
        <input type="text" name="perExercise.duration" placeholder="perExercise.duration">
        <input type="text" name="perExercise.caloriesBurned" placeholder="perExercise.caloriesBurned">
        <input type="submit" value="Log Workout">
    </form>
</main> -->


<hr/>
<section>
    <h1>Stay Motivated</h1> 
    <p>Let's find out what kinds of exercises or activities motivate you.</p>  
    <form name="motivate" onsubmit="identify(event)">
        What is the name of the exercise / activity / motivation?
        <input name="motivation"  size="81" value="run" type="text"/> 
        <br><br><br> 
        Motivation Description (What do you do, for how long, with whom, in repeptitions?):
        <br><br> 
        <section>
            action: <input name="action"  size="75" value="running non-stop" type="text"/> 
            <br><br>duration: <input name="duration"  size="75" value="25 min" type="text"/> 
            <br><br>partners: <input name="partners"  size="75" value="solo" type="text"/> 
            <br><br>
            <textarea cols="81" name="details" placeholder="additional details" rows="5"></textarea> 
        </section>
        <br><br> 
        Name: <input name="fullname"  size="75" value="" type="text"/> 
        <br><br> 
        Email: <input name="email" required="" size="75" value="" type="email"/> 
        <br><br>
        <input name="submit" type="submit" value="submit"/>
    </form> 

</section>



<script type="text/javascript">
    //let userId
    //const createUserId = () => {
    //    if(!userId){
    //        return userId = Math.floor((Math.random() * 100000) + 1);
    //    }
    //    else{
    //        console.log("userId exists:" + userId )
    //        return userId
    //    }
    //}

    console.log(`Date.now() = `+ Date.now());
    let currentSessionId
    console.log(`currentSessionId should be blank : ` + currentSessionId)
    
    let newSession = true
    const uTC = () => {
        if (!newSession){
            console.log(`currentSessionId should be same : `+currentSessionId)
            return currentSessionId
        }
        else {
            currentSessionId = Date.now()    
            console.log(`currentSessionId should change : `+currentSessionId)
            newSession = false
            return currentSessionId
        }
    }


    const identify = (e) =>{
        e.preventDefault();
        let form = e.target;
        let email = form["email"].value;
        let fullname = form["fullname"].value;
        let motivation = form["motivation"].value;
        let action = form["action"].value;
        let duration = form["duration"].value;
        let partners = form["partners"].value;
        let details = form["details"].value;
        let username, phone_number

        let traits = {
            email: email, 
            name: fullname, 
            username: username,
            userId : username,
            phone_number: phone_number,

        }

        let properties = {
            motivation: motivation, 
            action: action,
            duration: duration,
            partners: partners,
            details: details,
        };
        console.log(properties)
        analytics.identify({},traits);

        analytics.track('Motivation Submitted', properties, 
            {integrations: 
                {
                    "All": true,
                    "Amplitude": {
                        session_id: uTC()
                    }
                }}, 
                function() {
                window.location.href = "";
                //window.location.reload();
            }
        );
        redirect="/";
        }


        //analytics.track('User Logged Out', properties,
//            {integrations: 
//                {
//                "All": true,
//                "Amplitude": {
//                    session_id: uTC()
//                    }
//                }
//            }, 
//            function() {newSession=true}
//        );




</script>


    
</body>
<footer>
    <%- include('../partials/footer') %>
</footer>
</html>