<!DOCTYPE html> 
<html> 
<head> 
    <title>Home Questionnaire<span id="selection-marker-1" class="redactor-selection-marker"></span></title> 

    <!--Segment Snippet --> 
    <script>
      !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="GHWp3Jhvn2GBHxspEdZBRVhDmJKM4XC1";analytics.SNIPPET_VERSION="4.13.2";
      analytics.load("GHWp3Jhvn2GBHxspEdZBRVhDmJKM4XC1");
      analytics.page();
      }}();
    </script> 

    <!-- Global site tag (gtag.js) - Google Analytics -->
<!--     <script async src="https://www.googletagmanager.com/gtag/js?id=UA-198119530-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-198119530-1');
    </script> -->

</head> 
<body> 
<h1>What is your favorite place to travel?</h1> 
<p>I am building a directory of the sweetest travel destinations.</p>  
<form name="travel" onsubmit="identify(event)">
     What is your favorite travel destination?
    <input name="destination"  size="81" type="text"/> 
    <br><br><br> 
    Any recommendations (cool things to do, places to visit or restaurants to eat)? 
    <br><br> 
    <textarea cols="81" name="details"  rows="10">
    </textarea> 
    <br><br> 
    Name: <input name="fullname"  size="75" type="text"/> 
    <br><br> 
    Email: <input name="email" required="" size="75" type="email"/> 
    <br><br>
    <input name="submit" type="submit" value="submit"/>
</form> 

    <!--Segment identify and track script -->
    <script type="text/javascript">
//         let userId 
//         const createUserId = () => {
//             return userId = Math.floor((Math.random() * 100000) + 1);
//         }

// USER ID DOES NOT NEED TO BE PASSED
//         const createUserId = () => {
//             if(!userId){
//                 return userId = Math.floor((Math.random() * 100000) + 1);
//             }
//             else{
//                 console.log("userId exists:" + userId )
//                 return userId
//             }
//         }
        
        console.log(`Date.now() = `+ Date.now());
        let currentSessionId
        console.log(`currentSessionId should be blank : `+currentSessionId)
        
        let newSession = true
        const uTC = () => {
            if (!newSession){
                return currentSessionId
                console.log(`currentSessionId should be same : `+currentSessionId)
            }
            else {
                return currentSessionId = Date.now()    
                console.log(`currentSessionId should change : `+currentSessionId)
                newSession = false
            }
        }
        
      function identify(e){
        e.preventDefault();
        var form = e.target;
        var email = form["email"].value;
        var fullname = form["fullname"].value;
        var destination = form["destination"].value;
        var details = form["details"].value;
//         let session_id = Date.now()
        let session_id = uTC()
        var properties = {
            email: email, 
            name: fullname, 
            destination: destination, 
            details: details,
        };
        console.log(properties);
        analytics.identify({
          email: email, 
          name: fullname
        });
//         analytics.track('destination submitted',{},{integrations: {

        analytics.track('destination submitted',properties,{integrations: {
            "All": true,
            "Amplitude": {
                session_id: currentSessionId
            }
        }}, function() {
            window.location.href = "";
        });
      }
    </script>  

</body> 
</html>
