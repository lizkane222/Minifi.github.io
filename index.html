<!DOCTYPE html> 
<html> 
<head> 
    <title>Home Questionnaire<span id="selection-marker-1" class="redactor-selection-marker"></span></title> 

    <!--Segment Snippet --> 
    <script>
        // global variable anonymousId, assigned on page call, accessible if sent serverside
        let serverAnonymousId
        let serverUserId = 0
        let userId = null
        // function to be ran on load after .page() has completed and anonymousId is not null
        const callServer = () => {
            // assign variable value
            serverAnonymousId = analytics.user().anonymousId();
            // view variable value in console
            console.log('serverAnonymousId ',serverAnonymousId)
            console.log("serverUserId : ",serverUserId)

            if(!serverUserId){
                console.log("NEW USER - serverUserId 'falsey':" + serverUserId )
                serverUserId = Math.floor((Math.random() * 100000) + 1);
                console.log("NEW USER - serverUserId 'truthy':" + serverUserId )
            }
            else{
                console.log("serverUserId exists 'truthy': " + serverUserId )
            }
            
            console.log('serverUserId ',serverUserId)
            
            // return value to be used on backend
            return (serverAnonymousId,serverUserId)
        }  
      


        
      !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="GHWp3Jhvn2GBHxspEdZBRVhDmJKM4XC1";analytics.SNIPPET_VERSION="4.13.2";
      analytics.load("GHWp3Jhvn2GBHxspEdZBRVhDmJKM4XC1");
      analytics.page();
      analytics.ready(callServer);

      }}();
    </script> 

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poiret+One&display=swap" rel="stylesheet">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<!--     <script async src="https://www.googletagmanager.com/gtag/js?id=UA-198119530-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-198119530-1');
    </script> -->

</head> 
<style>
    body{
        /* padding-top: 50px; */
        font-family: 'Poiret One', cursive;
        background-color: rgba(20,20,20,1);
        color: rgba(220,220,220,8);
    }
    
    .navBar {
        width: 100%;
        /* height: 5vh; */
        background-color: aquamarine;
        display: flex;
        justify-content: space-between;
    }

    navBar-link, nav a {
        font-size: 1.5em;
        display: inline-block;
        text-align: left;
        margin: 0 10px;
    } 

    .resetUser {
        background-color: maroon;  
        color: gainsboro;
        padding: 2.5% .5%;
        border-radius: 50px;
        float: right;
        display: block;
        border: none;
        outline: none;
        
    }
    button:focus {
        border: none;
        outline: none;
    }
    .foot-index-container{
        margin: 15vh 15vw;
        padding: 2vh;
        background-color: rgba(70,70,70,.5);
        color: aqua;
        text-align: center;
    }
   
</style>

<body> 
    
<header id="navBar" class="clearfix">
    <nav class="navbar navbar-expand-lg ">
        <ul class="navbar-nav mr-auto">
            <a class="navbar-brand" onclick=trackNavRoute("logo","destinationForm") href="http://localhost:4000/"><h3>minifi</h3></a>
            <li class="nav-item">
                <a class="nav-link" onclick=trackNavRoute("home","destinationForm") href="http://localhost:4000/">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick=trackNavRoute("motivate","destinationForm") href="http://localhost:4000/motivate">Motivate</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick=trackNavRoute("mi chi","destinationForm") href="http://localhost:4000/chi">Mi Chi</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick=trackNavRoute("user","destinationForm") href="http://localhost:4000/user">User</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" onclick=trackNavRoute("about","destinationForm") href="http://localhost:4000/about">About minifi</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick=trackNavRoute("ghpages","destinationForm") href="https://lizkane222.github.io/Minifi.github.io/">GH PAGES</a>
            </li>

        </ul>
    </nav>
    <input type="button" onclick=runResetUser() class="resetUser" value="RESET USER"/>
</header>    
    
<main>
    <h1>What is your favorite place to travel?</h1> 
    <p>I am building a directory of the sweetest travel destinations.</p>  
    <form name="travel" onsubmit="identify(event)">
         What is your favorite travel destination?
        <input name="destination"  size="81" type="text"/> 
        <br><br><br> 
        Any recommendations (cool things to do, places to visit or restaurants to eat)? 
        <br><br> 
        <textarea cols="81" name="details"  rows="10">
        </textarea> 
        <br><br> 
        Name: <input name="fullname"  size="75" type="text"/> 
        <br><br> 
        Email: <input name="email" required="" size="75" type="email"/> 
        <br><br>
        <input name="submit" type="submit" value="submit"/>
    </form> 
</main>

    
<div class="foot-index-container">
    <input type="text" name="firstName" required="" id="firstName-foot-index" placeholder="First Name"/>
    <p><button onclick=chooseFirstName(1,firstNames) class="auto-btn btn-small">1</button><button onclick=chooseFirstName(2,firstNames) class="auto-btn btn-small">2</button><button onclick=chooseFirstName(3,firstNames) class="auto-btn btn-small">3</button><button onclick=chooseFirstName(4,firstNames) class="auto-btn btn-small">4</button><button onclick=chooseFirstName(5,firstNames) class="auto-btn btn-small">5</button><button onclick=chooseFirstName(6,firstNames) class="auto-btn btn-small">6</button><button onclick=chooseFirstName(7,firstNames) class="auto-btn btn-small">7</button><button onclick=chooseFirstName(8,firstNames) class="auto-btn btn-small">8</button><button onclick=chooseFirstName(9,firstNames) class="auto-btn btn-small">9</button><button onclick=chooseFirstName(10,firstNames) class="auto-btn btn-small">10</button><button onclick=chooseFirstName(11,firstNames) class="auto-btn btn-small">11</button><button onclick=chooseFirstName(12,firstNames) class="auto-btn btn-small">12</button><button onclick=chooseFirstName(13,firstNames) class="auto-btn btn-small">13</button><button onclick=chooseFirstName(14,firstNames) class="auto-btn btn-small">14</button><button onclick=chooseFirstName(15,firstNames) class="auto-btn btn-small">15</button></p>
    <p><button onclick=chooseFirstName(1,shouldersFam) class="auto-btn btn-small">1</button><button onclick=chooseFirstName(2,shouldersFam) class="auto-btn btn-small">2</button><button onclick=chooseFirstName(3,shouldersFam) class="auto-btn btn-small">3</button><button onclick=chooseFirstName(4,shouldersFam) class="auto-btn btn-small">4</button><button onclick=chooseFirstName(5,shouldersFam) class="auto-btn btn-small">5</button><button onclick=chooseFirstName(6,shouldersFam) class="auto-btn btn-small">6</button><button onclick=chooseFirstName(7,shouldersFam) class="auto-btn btn-small">7</button><button onclick=chooseFirstName(8,shouldersFam) class="auto-btn btn-small">8</button><button onclick=chooseFirstName(9,shouldersFam) class="auto-btn btn-small">9</button><button onclick=chooseFirstName(10,shouldersFam) class="auto-btn btn-small">10</button><button onclick=chooseFirstName(11,shouldersFam) class="auto-btn btn-small">11</button><button onclick=chooseFirstName(12,shouldersFam) class="auto-btn btn-small">12</button><button onclick=chooseFirstName(13,shouldersFam) class="auto-btn btn-small">13</button><button onclick=chooseFirstName(14,shouldersFam) class="auto-btn btn-small">14</button><button onclick=chooseFirstName(15,shouldersFam) class="auto-btn btn-small">15</button></p>

    <input type="text" name="lastName" id="lastName-foot-index" required="" placeholder="Last Name"/>
            <p><button onclick=chooseLastName(1) class="auto-btn btn-small">1</button><button onclick=chooseLastName(2) class="auto-btn btn-small">2</button><button onclick=chooseLastName(3) class="auto-btn btn-small">3</button><button onclick=chooseLastName(4) class="auto-btn btn-small">4</button><button onclick=chooseLastName(5) class="auto-btn btn-small">5</button><button onclick=chooseLastName(6) class="auto-btn btn-small">6</button><button onclick=chooseLastName(7) class="auto-btn btn-small">7</button><button onclick=chooseLastName(8) class="auto-btn btn-small">8</button><button onclick=chooseLastName(9) class="auto-btn btn-small">9</button><button onclick=chooseLastName(10) class="auto-btn btn-small">10</button><button onclick=chooseLastName(11) class="auto-btn btn-small">11</button><button onclick=chooseLastName(12) class="auto-btn btn-small">12</button><button onclick=chooseLastName(13) class="auto-btn btn-small">13</button><button onclick=chooseLastName(14) class="auto-btn btn-small">14</button><button onclick=chooseLastName(15) class="auto-btn btn-small">15</button></p>
    
    <input type="text" name="organization" id="organization-foot-index" required="" placeholder="Organization"/>
    <p><button onclick=chooseOrganizationName(1) class="auto-btn btn-small">1</button><button onclick=chooseOrganizationName(2) class="auto-btn btn-small">2</button><button onclick=chooseOrganizationName(3) class="auto-btn btn-small">3</button><button onclick=chooseOrganizationName(4) class="auto-btn btn-small">4</button><button onclick=chooseOrganizationName(5) class="auto-btn btn-small">5</button><button onclick=chooseOrganizationName(6) class="auto-btn btn-small">6</button><button onclick=chooseOrganizationName(7) class="auto-btn btn-small">7</button><button onclick=chooseOrganizationName(8) class="auto-btn btn-small">8</button><button onclick=chooseOrganizationName(9) class="auto-btn btn-small">9</button><button onclick=chooseOrganizationName(10) class="auto-btn btn-small">10</button><button onclick=chooseOrganizationName(11) class="auto-btn btn-small">11</button><button onclick=chooseOrganizationName(12) class="auto-btn btn-small">12</button><button onclick=chooseOrganizationName(13) class="auto-btn btn-small">13</button><button onclick=chooseOrganizationName(14) class="auto-btn btn-small">14</button><button onclick=chooseOrganizationName(15) class="auto-btn btn-small">15</button></p>

    <input type="email" name="email" id="email-foot-index" required="" placeholder="Email"/>
    <p><button onclick=chooseEmail(1) class="auto-btn btn-small">1</button><button onclick=chooseEmail(2) class="auto-btn btn-small">2</button><button onclick=chooseEmail(3) class="auto-btn btn-small">3</button><button onclick=chooseEmail(4) class="auto-btn btn-small">4</button><button onclick=chooseEmail(5) class="auto-btn btn-small">5</button><button onclick=chooseEmail(6) class="auto-btn btn-small">6</button><button onclick=chooseEmail(7) class="auto-btn btn-small">7</button><button onclick=chooseEmail(8) class="auto-btn btn-small">8</button><button onclick=chooseEmail(9) class="auto-btn btn-small">9</button><button onclick=chooseEmail(10) class="auto-btn btn-small">10</button><button onclick=chooseEmail(11) class="auto-btn btn-small">11</button><button onclick=chooseEmail(12) class="auto-btn btn-small">12</button><button onclick=chooseEmail(13) class="auto-btn btn-small">13</button><button onclick=chooseEmail(14) class="auto-btn btn-small">14</button><button onclick=chooseEmail(15) class="auto-btn btn-small">15</button></p>

    <input type="text" name="favoriteSocialMedia" id="fav-soc-media-foot-index" required="" placeholder="Favorite Social Media To Use"/>
    <p><button onclick=chooseSocialMedia(1) class="auto-btn btn-small">1</button><button onclick=chooseSocialMedia(2) class="auto-btn btn-small">2</button><button onclick=chooseSocialMedia(3) class="auto-btn btn-small">3</button><button onclick=chooseSocialMedia(4) class="auto-btn btn-small">4</button><button onclick=chooseSocialMedia(5) class="auto-btn btn-small">5</button><button onclick=chooseSocialMedia(6) class="auto-btn btn-small">6</button><button onclick=chooseSocialMedia(7) class="auto-btn btn-small">7</button><button onclick=chooseSocialMedia(8) class="auto-btn btn-small">8</button><button onclick=chooseSocialMedia(9) class="auto-btn btn-small">9</button><button onclick=chooseSocialMedia(10) class="auto-btn btn-small">10</button><button onclick=chooseSocialMedia(11) class="auto-btn btn-small">11</button><button onclick=chooseSocialMedia(12) class="auto-btn btn-small">12</button><button onclick=chooseSocialMedia(13) class="auto-btn btn-small">13</button><button onclick=chooseSocialMedia(14) class="auto-btn btn-small">14</button><button onclick=chooseSocialMedia(15) class="auto-btn btn-small">15</button></p>

    <input type="text" name="userName" id="userName-foot-index" required="" placeholder="Choose a username"/>
    <p><button onclick=chooseUserName(1) class="auto-btn btn-small">1</button><button onclick=chooseUserName(2) class="auto-btn btn-small">2</button><button onclick=chooseUserName(3) class="auto-btn btn-small">3</button><button onclick=chooseUserName(4) class="auto-btn btn-small">4</button><button onclick=chooseUserName(5) class="auto-btn btn-small">5</button><button onclick=chooseUserName(6) class="auto-btn btn-small">6</button><button onclick=chooseUserName(7) class="auto-btn btn-small">7</button><button onclick=chooseUserName(8) class="auto-btn btn-small">8</button><button onclick=chooseUserName(9) class="auto-btn btn-small">9</button><button onclick=chooseUserName(10) class="auto-btn btn-small">10</button><button onclick=chooseUserName(11) class="auto-btn btn-small">11</button><button onclick=chooseUserName(12) class="auto-btn btn-small">12</button><button onclick=chooseUserName(13) class="auto-btn btn-small">13</button><button onclick=chooseUserName(14) class="auto-btn btn-small">14</button><button onclick=chooseUserName(15) class="auto-btn btn-small">15</button></p>
    <button id="submitNewAccountInputs" onclick=createNewAccount()>SAVE</button>
</div>
<footer class="text-center text-muted footer">
    <p>&#169 minifi </p>
</footer>
<!--Segment identify and track script -->
<script type="text/javascript">

    console.log(`Date.now() = `+ Date.now());
    let currentSessionId
    console.log(`currentSessionId should be blank : `+currentSessionId)

    let newSession = true
    const uTC = () => {
        if (!newSession){
            return currentSessionId
            console.log(`currentSessionId should be same : `+currentSessionId)
        }
        else {
            return currentSessionId = Date.now()    
            console.log(`currentSessionId should change : `+currentSessionId)
            newSession = false
        }
    }

  function identify(e){
    e.preventDefault();
    var form = e.target;
    var email = form["email"].value;
    var fullname = form["fullname"].value;
    var destination = form["destination"].value;
    var details = form["details"].value;
//         let session_id = Date.now()
    let session_id = uTC()
    var properties = {
        email: email, 
        name: fullname, 
        destination: destination, 
        details: details,
    };
    console.log(properties);
    analytics.identify({
      email: email, 
      name: fullname
    });
//         analytics.track('destination submitted',{},{integrations: {

    analytics.track('destination submitted',properties,{integrations: {
        "All": true,
        "Amplitude": {
            session_id: currentSessionId
        }
    }}, function() {
        window.location.href = "";
    });
  }

  const trackNavRoute = (navLinkName, currentPage) => {
        let properties = {
            navLinkName : navLinkName,
            currentPage : currentPage
        }

         analytics.track('navlink clicked',properties,{integrations: {
            "All": true,
            "Amplitude": {
                session_id: currentSessionId
            }
        }}, function() {
            window.location.href = "";
        });
   }


const runResetUser = () => {
    analytics.reset()
    console.log("reset has occured");
    console.log(Headers)
    serverAnonymousId = 0
    serverUserId = 0
}

let shouldersFam = ["Randy","Helen","Lara","Tobie","Emily","Nick","Liz","Zack","Molly","Courtney","Luke","Micah","Austin","Taylor","Lilly","Ernest","Ellis"]
    let firstNames = ["Liz","Jason","Lucy","Michael","Nicole","Alison","Paige","Lyn","Louise","Isaac","Ann","Marie","Justin","Harold","Esteban","Carl",]
    

    let firstNameInput 
    const chooseFirstName = (num,array) =>{
        console.log(array.length)
        firstNameInput = array[num]
        document.getElementById("firstName-foot-index").value = firstNameInput;
    }
    let lastNameInput
    const chooseLastName = (num) => {
        let lastNames = ["Baker","Welder","Farmer","Cook","Butler","Maid","Equester","Rancher","Cleaner","Marketer","Engineer","Analyst","Scientist","Optometrist","Professor","Translator",]
        console.log(lastNames.length)
        lastNameInput = lastNames[num]
        document.getElementById("lastName-foot-index").value = lastNameInput;
    }
    let organizationInput
    let chooseOrganizationName = (num) => {
        organizationInput = (lastNameInput+num+" Inc")
        document.getElementById("organization-foot-index").value = organizationInput;
    }
    let emailInput
    let mudra = ["Earth","Wind","Fire","Ether","Water","Mountain","Grass","Star","Planet","Soul","Life","Unity","Serenity","Peace","Harmony","Ocean","Magma",]
    const chooseEmail = (num) => {
        console.log(mudra.length)
        emailInput = (`${firstNameInput}${lastNameInput}${num}@${mudra[num]}.com`)
        document.getElementById("email-foot-index").value = emailInput;
    }
    let favSocMediaInput
    const chooseSocialMedia = (num) => {
        let allSoc = ["Twitter","Instagram","Tik Tok","Facebook","Myspace","Rodeo","Food Network","Music","Pinterest","LinkedIn","Tumblr","Reddit","Snapchat","WhatsApp","BixSugar","YouTube",]
        console.log(allSoc.length)
        favSocMediaInput = allSoc[num]
        document.getElementById("fav-soc-media-foot-index").value = favSocMediaInput;
    }
    let userNameInput
    const chooseUserName = (num) => {
        //let allSoc = ["Twitter","Instagram","Tik Tok","Facebook","Myspace","Rodeo","Food Network","Music","Pinterest","LinkedIn","Tumblr","Reddit","Snapchat","WhatsApp","BixSugar","YouTube",]
        //console.log(allSoc.length)
        userNameInput = (`${firstNameInput}${mudra[num]}${num}`)
        document.getElementById("userName-foot-index").value = userNameInput;
    }


const createNewAccount = () => {

        let firstName = document.getElementById("firstName-foot-index").value;
        let lastName = document.getElementById("lastName-foot-index").value;
        let organization = document.getElementById("organization-foot-index").value;
        let email = document.getElementById("email-foot-index").value;
        let favSocMedia = document.getElementById("fav-soc-media-foot-index").value;
        let userName = document.getElementById("userName-foot-index").value;

    console.log(`firstNameInput : `,firstNameInput,`  --  firstName : `,firstName);
    console.log(`lastNameInput : `,lastNameInput,`  --  lastName : `,lastName);
    console.log(`organizationInput : `,organizationInput,`  --  organization : `,organization);
    console.log(`emailInput : `,emailInput,`  --  email : `,email);
    console.log(`favSocMediaInput : `,favSocMediaInput,`  --  favSocMedia : `,favSocMedia);
    console.log(`userNameInput : `,userNameInput,`  --  userName : `,userName);

    let traits = {
        Email : email,
        favSocMedia : favSocMedia,
        anonymousId : serverAnonymousId,
        name : (`${firstName} ${lastName}`),
        organization : organization,
        userId : serverUserId,
        firstName : firstName,
        lastName : lastName,
        userName : userName,
        givenName : firstName,
        surname : lastName,
    }

    let properties = {
        Email : email,
        favSocMedia : favSocMedia,
        anonymousId : serverAnonymousId,
        name : (`${firstName} ${lastName}`),
        organization : organization,
        userId : serverUserId,
        firstName : firstName,
        lastName : lastName,
        userName : userName,
        givenName : firstName,
        surname : lastName,
    }
    //serverUserId ? serverUserId : serverAnonymousId
    // BELOW IDENTIFY CALL WORKED
    //     analytics.identify((serverUserId ? serverUserId : serverAnonymousId),traits)
    analytics.identify(traits.userId,traits,{integrations:{"All":false,"Marketo V2":true}})

    //analytics.identify({},traits);

    // analytics.track(event, [properties], [options], [callback]);
//     analytics.track("New Account Created",properties,
//         function() {window.location.href = "";})
    // BELOW TRACK CALL WORKED
     analytics.track("New Account Created",
            properties,
            {userId:userId,
                integrations:{"All":false,"Marketo V2":true}},
           function() {
                window.location.href = "";
            }
       )
    

    //document.getElementById("submitNewAccountInputs").addEventListener("click",createNewAccount,true)

} 

</script>
</body> 
</html>

